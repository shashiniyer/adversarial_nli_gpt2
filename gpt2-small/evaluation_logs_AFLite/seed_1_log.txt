(text) lnx00191 [~/adversarial_nli_gpt2]> python3 evaluate_AFLite.py 1
Begin: In-Distribution Evaluation - SNLI test - Zero-Shot
Reusing dataset snli (/home/shana92/.cache/huggingface/datasets/snli/plain_text/1.0.0/1f60b67533b65ae0275561ff7828aad5ee4282d0e6f844fd148d05d3c6ea251b)
100%|████████████████████████████████| 10/10 [00:00<00:00, 274.20ba/s]
100%|████████████████████████████████| 10/10 [00:00<00:00, 162.44ba/s]
100%|███████████████████████████| 9824/9824 [00:01<00:00, 5830.30ex/s]
100%|█████████████████████████████████| 10/10 [00:00<00:00, 51.11ba/s]
  0%|          | 0/77 [00:00<?, ?it/s]
Seed: 1 - Dataset: SNLI (test) - Accuracy: 84.100163%, RK: 0.761860
End: In-Distribution Evaluation - SNLI test - Zero-Shot

Begin: Out-of-Distribution Evaluation - HANS - Zero-Shot
Reusing dataset hans (/home/shana92/.cache/huggingface/datasets/hans/plain_text/1.0.0/452e93cf5383f5ae39088254215b517d0da98ccaaf0af8f7ab04d8f23f67dbd9)
100%|████████████████████████████████| 30/30 [00:00<00:00, 107.70ba/s]
100%|█████████████████████████████████| 30/30 [00:00<00:00, 54.40ba/s]
100%|█████████████████████████| 30000/30000 [00:05<00:00, 5520.12ex/s]
100%|█████████████████████████████████| 30/30 [00:00<00:00, 47.75ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 27.23ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 26.21ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 27.19ba/s]
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 1 - Dataset: constituent - Accuracy: 49.790001%, RK: -0.032094
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 1 - Dataset: lexical_overlap - Accuracy: 50.010002%, RK: 0.010000
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 1 - Dataset: subsequence - Accuracy: 50.070000%, RK: 0.026467
End: Out-of-Distribution Evaluation - HANS - Zero-Shot
Begin: Out-of-Distribution Evaluation - NLI Diagnostics - Zero-Shot
100%|███████████████████████████| 1104/1104 [00:00<00:00, 8812.77ex/s]
100%|███████████████████████████| 1104/1104 [00:00<00:00, 4413.30ex/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 56.96ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.52ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.02ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.17ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.38ba/s]
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 1 - Dataset: Lexical Semantics - Accuracy: 44.565219%, RK: 0.142366
  0%|          | 0/4 [00:00<?, ?it/s]
Seed: 1 - Dataset: Predicate-Argument Structure - Accuracy: 57.075471%, RK: 0.267739
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 1 - Dataset: Logic - Accuracy: 42.582417%, RK: 0.133744
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 1 - Dataset: Knowledge - Accuracy: 36.971831%, RK: 0.079701
End: Out-of-Distribution Evaluation - NLI Diagnostics - Zero-Shot
Begin: Out-of-Distribution Evaluation - Stress Tests - Zero-Shot
100%|████████████████████████| 24071/24071 [00:02<00:00, 10467.97ex/s]
100%|█████████████████████████| 24071/24071 [00:05<00:00, 4383.39ex/s]
100%|█████████████████████████████████| 25/25 [00:00<00:00, 34.84ba/s]
Heuristic: Competence - 396 (1.672650%) sequences excluded
100%|██████████████████████| 294705/294705 [00:28<00:00, 10358.37ex/s]
100%|███████████████████████| 294705/294705 [01:07<00:00, 4362.52ex/s]
100%|███████████████████████████████| 295/295 [00:08<00:00, 32.99ba/s]
Heuristic: Distraction - 1060 (0.360980%) sequences excluded
100%|██████████████████████| 333160/333160 [00:32<00:00, 10395.40ex/s]
100%|███████████████████████| 333160/333160 [01:11<00:00, 4671.88ex/s]
100%|███████████████████████████████| 334/334 [00:08<00:00, 37.27ba/s]
Heuristic: Noise - 1070 (0.322202%) sequences excluded
  0%|          | 0/185 [00:00<?, ?it/s]
Seed: 1 - Dataset: Competence - Accuracy: 29.892293%, RK: -0.162680
  0%|          | 0/2295 [00:00<?, ?it/s]
Seed: 1 - Dataset: Distraction - Accuracy: 50.097907%, RK: 0.263127
  0%|          | 0/2595 [00:00<?, ?it/s]
Seed: 1 - Dataset: Noise - Accuracy: 53.631544%, RK: 0.308882
End: Out-of-Distribution Evaluation - Stress Tests - Zero-Shot
Begin: Out-of-Distribution Evaluation - ANLI - Zero-Shot
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████| 17/17 [00:00<00:00, 230.53ba/s]
100%|█████████████████████████| 16946/16946 [00:05<00:00, 3078.80ex/s]
100%|█████████████████████████████████| 17/17 [00:00<00:00, 20.25ba/s]
Split: train_r1 - 446 (2.703030%) sequences excluded
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.669565  [    0/16500]
loss: 0.630346  [ 1600/16500]
loss: 0.660996  [ 3200/16500]
loss: 0.609198  [ 4800/16500]
loss: 0.645295  [ 6400/16500]
loss: 0.609860  [ 8000/16500]
loss: 0.626295  [ 9600/16500]
loss: 0.596745  [11200/16500]
loss: 0.633052  [12800/16500]
loss: 0.636137  [14400/16500]
loss: 0.595055  [16000/16500]
Epoch average loss: 0.6289039850234985
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.632819  [    0/16500]
loss: 0.618333  [ 1600/16500]
loss: 0.628684  [ 3200/16500]
loss: 0.629714  [ 4800/16500]
loss: 0.629704  [ 6400/16500]
loss: 0.581015  [ 8000/16500]
loss: 0.615360  [ 9600/16500]
loss: 0.617359  [11200/16500]
loss: 0.605739  [12800/16500]
loss: 0.597539  [14400/16500]
loss: 0.609021  [16000/16500]
Epoch average loss: 0.6204270720481873
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.590293  [    0/16500]
loss: 0.598824  [ 1600/16500]
loss: 0.622020  [ 3200/16500]
loss: 0.529871  [ 4800/16500]
loss: 0.625653  [ 6400/16500]
loss: 0.614689  [ 8000/16500]
loss: 0.608385  [ 9600/16500]
loss: 0.557782  [11200/16500]
loss: 0.597704  [12800/16500]
loss: 0.592929  [14400/16500]
loss: 0.632733  [16000/16500]
Epoch average loss: 0.6062754988670349
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████| 1/1 [00:00<00:00, 185.70ba/s]
100%|███████████████████████████| 1000/1000 [00:00<00:00, 3086.71ex/s]
100%|███████████████████████████████████| 1/1 [00:00<00:00, 19.99ba/s]
Split: test_r1 - 23 (2.354145%) sequences excluded
  0%|          | 0/16 [00:00<?, ?it/s]
Round: r1 - Seed: 1 - Accuracy: 33.469805%, RK: -0.001004
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████| 46/46 [00:00<00:00, 266.27ba/s]
100%|█████████████████████████| 45460/45460 [00:14<00:00, 3137.44ex/s]
100%|█████████████████████████████████| 46/46 [00:02<00:00, 21.03ba/s]
Split: train_r2 - 944 (2.120586%) sequences excluded
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.629535  [    0/44516]
loss: 0.604743  [ 4416/44516]
loss: 0.592782  [ 8832/44516]
loss: 0.624382  [13248/44516]
loss: 0.574326  [17664/44516]
loss: 0.599136  [22080/44516]
loss: 0.586800  [26496/44516]
loss: 0.589770  [30912/44516]
loss: 0.627572  [35328/44516]
loss: 0.614864  [39744/44516]
loss: 0.571936  [44160/44516]
Epoch average loss: 0.6087719202041626
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.587434  [    0/44516]
loss: 0.600725  [ 4416/44516]
loss: 0.570656  [ 8832/44516]
loss: 0.595361  [13248/44516]
loss: 0.529233  [17664/44516]
loss: 0.601247  [22080/44516]
loss: 0.596377  [26496/44516]
loss: 0.589030  [30912/44516]
loss: 0.547624  [35328/44516]
loss: 0.554287  [39744/44516]
loss: 0.573061  [44160/44516]
Epoch average loss: 0.5813897848129272
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.564318  [    0/44516]
loss: 0.582559  [ 4416/44516]
loss: 0.523969  [ 8832/44516]
loss: 0.595372  [13248/44516]
loss: 0.572132  [17664/44516]
loss: 0.576655  [22080/44516]
loss: 0.524584  [26496/44516]
loss: 0.519166  [30912/44516]
loss: 0.565245  [35328/44516]
loss: 0.524747  [39744/44516]
loss: 0.572082  [44160/44516]
Epoch average loss: 0.5494515299797058
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████| 1/1 [00:00<00:00, 148.80ba/s]
100%|███████████████████████████| 1000/1000 [00:00<00:00, 3123.94ex/s]
100%|███████████████████████████████████| 1/1 [00:00<00:00, 20.20ba/s]
Split: test_r2 - 18 (1.832994%) sequences excluded
  0%|          | 0/16 [00:00<?, ?it/s]
Round: r2 - Seed: 1 - Accuracy: 30.549899%, RK: -0.043104
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████| 101/101 [00:00<00:00, 266.09ba/s]
100%|███████████████████████| 100459/100459 [00:29<00:00, 3356.78ex/s]
100%|███████████████████████████████| 101/101 [00:04<00:00, 21.23ba/s]
Split: train_r3 - 7468 (8.030885%) sequences excluded
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.608748  [    0/92991]
loss: 0.617735  [ 9280/92991]
loss: 0.595315  [18560/92991]
loss: 0.647960  [27840/92991]
loss: 0.589128  [37120/92991]
loss: 0.596310  [46400/92991]
loss: 0.605667  [55680/92991]
loss: 0.577491  [64960/92991]
loss: 0.590040  [74240/92991]
loss: 0.545111  [83520/92991]
loss: 0.615152  [92800/92991]
Epoch average loss: 0.5918555855751038
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.606780  [    0/92991]
loss: 0.517493  [ 9280/92991]
loss: 0.546144  [18560/92991]
loss: 0.597450  [27840/92991]
loss: 0.545372  [37120/92991]
loss: 0.522900  [46400/92991]
loss: 0.584467  [55680/92991]
loss: 0.602458  [64960/92991]
loss: 0.505134  [74240/92991]
loss: 0.526060  [83520/92991]
loss: 0.524560  [92800/92991]
Epoch average loss: 0.5643051862716675
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.494045  [    0/92991]
loss: 0.504802  [ 9280/92991]
loss: 0.561744  [18560/92991]
loss: 0.585691  [27840/92991]
loss: 0.483106  [37120/92991]
loss: 0.536189  [46400/92991]
loss: 0.518025  [55680/92991]
loss: 0.548269  [64960/92991]
loss: 0.539128  [74240/92991]
loss: 0.477800  [83520/92991]
loss: 0.675518  [92800/92991]
Epoch average loss: 0.5364229679107666
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████| 2/2 [00:00<00:00, 298.27ba/s]
100%|███████████████████████████| 1200/1200 [00:00<00:00, 3328.46ex/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 35.60ba/s]
Split: test_r3 - 90 (8.108108%) sequences excluded
  0%|          | 0/18 [00:00<?, ?it/s]
Round: r3 - Seed: 1 - Accuracy: 34.414414%, RK: 0.013099
End: Out-of-Distribution Evaluation - ANLI - Zero-Shot
(text) lnx00191 [~/adversarial_nli_gpt2]> 
