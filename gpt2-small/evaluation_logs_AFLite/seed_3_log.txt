(text) lnx00191 [~/adversarial_nli_gpt2]> python3 evaluate_AFLite.py  3; python3 evaluate_AFLite.py 4
Begin: In-Distribution Evaluation - SNLI test - Zero-Shot
Reusing dataset snli (/home/shana92/.cache/huggingface/datasets/snli/plain_text/1.0.0/1f60b67533b65ae0275561ff7828aad5ee4282d0e6f844fd148d05d3c6ea251b)
100%|████████████████████████████████| 10/10 [00:00<00:00, 244.46ba/s]
100%|████████████████████████████████| 10/10 [00:00<00:00, 168.07ba/s]
100%|███████████████████████████| 9824/9824 [00:01<00:00, 6027.01ex/s]
100%|█████████████████████████████████| 10/10 [00:00<00:00, 53.75ba/s]
  0%|          | 0/77 [00:00<?, ?it/s]
Seed: 3 - Dataset: SNLI (test) - Accuracy: 83.927119%, RK: 0.758964
End: In-Distribution Evaluation - SNLI test - Zero-Shot

Begin: Out-of-Distribution Evaluation - HANS - Zero-Shot
Reusing dataset hans (/home/shana92/.cache/huggingface/datasets/hans/plain_text/1.0.0/452e93cf5383f5ae39088254215b517d0da98ccaaf0af8f7ab04d8f23f67dbd9)
100%|████████████████████████████████| 30/30 [00:00<00:00, 112.82ba/s]
100%|█████████████████████████████████| 30/30 [00:00<00:00, 57.90ba/s]
100%|█████████████████████████| 30000/30000 [00:05<00:00, 5647.98ex/s]
100%|█████████████████████████████████| 30/30 [00:00<00:00, 48.12ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 28.61ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 27.47ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 28.56ba/s]
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 3 - Dataset: constituent - Accuracy: 49.990001%, RK: -0.010000
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 3 - Dataset: lexical_overlap - Accuracy: 50.000000%, RK: 0.000000
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 3 - Dataset: subsequence - Accuracy: 50.000000%, RK: 0.000000
End: Out-of-Distribution Evaluation - HANS - Zero-Shot
Begin: Out-of-Distribution Evaluation - NLI Diagnostics - Zero-Shot
100%|███████████████████████████| 1104/1104 [00:00<00:00, 8986.19ex/s]
100%|███████████████████████████| 1104/1104 [00:00<00:00, 4400.05ex/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 58.08ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.55ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 40.33ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 40.32ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.83ba/s]
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 3 - Dataset: Lexical Semantics - Accuracy: 46.195653%, RK: 0.147393
  0%|          | 0/4 [00:00<?, ?it/s]
Seed: 3 - Dataset: Predicate-Argument Structure - Accuracy: 59.433961%, RK: 0.293356
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 3 - Dataset: Logic - Accuracy: 41.483516%, RK: 0.113842
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 3 - Dataset: Knowledge - Accuracy: 39.788732%, RK: 0.091168
End: Out-of-Distribution Evaluation - NLI Diagnostics - Zero-Shot
Begin: Out-of-Distribution Evaluation - Stress Tests - Zero-Shot
100%|████████████████████████| 24071/24071 [00:02<00:00, 10448.52ex/s]
100%|█████████████████████████| 24071/24071 [00:05<00:00, 4432.56ex/s]
100%|█████████████████████████████████| 25/25 [00:00<00:00, 35.14ba/s]
Heuristic: Competence - 396 (1.672650%) sequences excluded
100%|██████████████████████| 294705/294705 [00:28<00:00, 10513.96ex/s]
100%|███████████████████████| 294705/294705 [01:06<00:00, 4446.45ex/s]
100%|███████████████████████████████| 295/295 [00:08<00:00, 32.83ba/s]
Heuristic: Distraction - 1060 (0.360980%) sequences excluded
100%|██████████████████████| 333160/333160 [00:31<00:00, 10651.82ex/s]
100%|███████████████████████| 333160/333160 [01:09<00:00, 4809.79ex/s]
100%|███████████████████████████████| 334/334 [00:08<00:00, 37.42ba/s]
Heuristic: Noise - 1070 (0.322202%) sequences excluded
  0%|          | 0/185 [00:00<?, ?it/s]
Seed: 3 - Dataset: Competence - Accuracy: 20.730728%, RK: -0.107798
  0%|          | 0/2295 [00:00<?, ?it/s]
Seed: 3 - Dataset: Distraction - Accuracy: 49.801630%, RK: 0.251556
  0%|          | 0/2595 [00:00<?, ?it/s]
Seed: 3 - Dataset: Noise - Accuracy: 55.030262%, RK: 0.326964
End: Out-of-Distribution Evaluation - Stress Tests - Zero-Shot
Begin: Out-of-Distribution Evaluation - ANLI - Zero-Shot
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████| 17/17 [00:00<00:00, 236.69ba/s]
100%|█████████████████████████| 16946/16946 [00:05<00:00, 3180.00ex/s]
100%|█████████████████████████████████| 17/17 [00:00<00:00, 20.46ba/s]
Split: train_r1 - 446 (2.703030%) sequences excluded
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.665615  [    0/16500]
loss: 0.629733  [ 1600/16500]
loss: 0.654156  [ 3200/16500]
loss: 0.607245  [ 4800/16500]
loss: 0.630459  [ 6400/16500]
loss: 0.605822  [ 8000/16500]
loss: 0.639702  [ 9600/16500]
loss: 0.599483  [11200/16500]
loss: 0.620783  [12800/16500]
loss: 0.626642  [14400/16500]
loss: 0.597488  [16000/16500]
Epoch average loss: 0.6310746073722839
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.633827  [    0/16500]
loss: 0.606025  [ 1600/16500]
loss: 0.630666  [ 3200/16500]
loss: 0.619649  [ 4800/16500]
loss: 0.624666  [ 6400/16500]
loss: 0.569748  [ 8000/16500]
loss: 0.605960  [ 9600/16500]
loss: 0.629727  [11200/16500]
loss: 0.599712  [12800/16500]
loss: 0.589461  [14400/16500]
loss: 0.604735  [16000/16500]
Epoch average loss: 0.6188844442367554
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.600004  [    0/16500]
loss: 0.588506  [ 1600/16500]
loss: 0.610545  [ 3200/16500]
loss: 0.545123  [ 4800/16500]
loss: 0.627005  [ 6400/16500]
loss: 0.581207  [ 8000/16500]
loss: 0.586730  [ 9600/16500]
loss: 0.559437  [11200/16500]
loss: 0.592412  [12800/16500]
loss: 0.598792  [14400/16500]
loss: 0.635181  [16000/16500]
Epoch average loss: 0.6027580499649048
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████| 1/1 [00:00<00:00, 184.86ba/s]
100%|███████████████████████████| 1000/1000 [00:00<00:00, 3180.21ex/s]
100%|███████████████████████████████████| 1/1 [00:00<00:00, 20.16ba/s]
Split: test_r1 - 23 (2.354145%) sequences excluded
  0%|          | 0/16 [00:00<?, ?it/s]
Round: r1 - Seed: 3 - Accuracy: 31.115660%, RK: -0.037325
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████| 46/46 [00:00<00:00, 272.34ba/s]
100%|█████████████████████████| 45460/45460 [00:14<00:00, 3221.34ex/s]
100%|█████████████████████████████████| 46/46 [00:02<00:00, 21.21ba/s]
Split: train_r2 - 944 (2.120586%) sequences excluded
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.613851  [    0/44516]
loss: 0.586686  [ 4416/44516]
loss: 0.607221  [ 8832/44516]
loss: 0.624632  [13248/44516]
loss: 0.573800  [17664/44516]
loss: 0.603013  [22080/44516]
loss: 0.588900  [26496/44516]
loss: 0.610739  [30912/44516]
loss: 0.634884  [35328/44516]
loss: 0.621180  [39744/44516]
loss: 0.573478  [44160/44516]
Epoch average loss: 0.6092653274536133
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.565690  [    0/44516]
loss: 0.578989  [ 4416/44516]
loss: 0.563138  [ 8832/44516]
loss: 0.585514  [13248/44516]
loss: 0.537619  [17664/44516]
loss: 0.613649  [22080/44516]
loss: 0.590535  [26496/44516]
loss: 0.581751  [30912/44516]
loss: 0.575361  [35328/44516]
loss: 0.568683  [39744/44516]
loss: 0.578306  [44160/44516]
Epoch average loss: 0.5804823637008667
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.525422  [    0/44516]
loss: 0.563897  [ 4416/44516]
loss: 0.521694  [ 8832/44516]
loss: 0.600578  [13248/44516]
loss: 0.612166  [17664/44516]
loss: 0.566517  [22080/44516]
loss: 0.546547  [26496/44516]
loss: 0.495351  [30912/44516]
loss: 0.572253  [35328/44516]
loss: 0.577142  [39744/44516]
loss: 0.515195  [44160/44516]
Epoch average loss: 0.5494141578674316
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|███████████████████████████████████| 1/1 [00:00<00:00, 95.81ba/s]
100%|███████████████████████████| 1000/1000 [00:00<00:00, 3127.30ex/s]
100%|███████████████████████████████████| 1/1 [00:00<00:00, 20.20ba/s]
Split: test_r2 - 18 (1.832994%) sequences excluded
  0%|          | 0/16 [00:00<?, ?it/s]
Round: r2 - Seed: 3 - Accuracy: 31.670061%, RK: -0.027598
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████| 101/101 [00:00<00:00, 279.48ba/s]
100%|███████████████████████| 100459/100459 [00:29<00:00, 3392.36ex/s]
100%|███████████████████████████████| 101/101 [00:04<00:00, 21.81ba/s]
Split: train_r3 - 7468 (8.030885%) sequences excluded
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.653315  [    0/92991]
loss: 0.641978  [ 9280/92991]
loss: 0.606461  [18560/92991]
loss: 0.639617  [27840/92991]
loss: 0.586938  [37120/92991]
loss: 0.593226  [46400/92991]
loss: 0.607121  [55680/92991]
loss: 0.584357  [64960/92991]
loss: 0.613801  [74240/92991]
loss: 0.547514  [83520/92991]
loss: 0.601849  [92800/92991]
Epoch average loss: 0.5917305946350098
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.596629  [    0/92991]
loss: 0.489128  [ 9280/92991]
loss: 0.527368  [18560/92991]
loss: 0.605129  [27840/92991]
loss: 0.535330  [37120/92991]
loss: 0.558075  [46400/92991]
loss: 0.579486  [55680/92991]
loss: 0.584635  [64960/92991]
loss: 0.511747  [74240/92991]
loss: 0.517844  [83520/92991]
loss: 0.530238  [92800/92991]
Epoch average loss: 0.5622004270553589
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.481380  [    0/92991]
loss: 0.515744  [ 9280/92991]
loss: 0.580809  [18560/92991]
loss: 0.602202  [27840/92991]
loss: 0.511032  [37120/92991]
loss: 0.550778  [46400/92991]
loss: 0.554685  [55680/92991]
loss: 0.553369  [64960/92991]
loss: 0.523807  [74240/92991]
loss: 0.481636  [83520/92991]
loss: 0.676788  [92800/92991]
Epoch average loss: 0.533828854560852
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████| 2/2 [00:00<00:00, 156.44ba/s]
100%|███████████████████████████| 1200/1200 [00:00<00:00, 3315.65ex/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 35.94ba/s]
Split: test_r3 - 90 (8.108108%) sequences excluded
  0%|          | 0/18 [00:00<?, ?it/s]
Round: r3 - Seed: 3 - Accuracy: 35.135135%, RK: 0.025829
End: Out-of-Distribution Evaluation - ANLI - Zero-Shot

