(text) lnx00191 [~/adversarial_nli_gpt2]> python3 evaluate_AFLite.py  2
Begin: In-Distribution Evaluation - SNLI test - Zero-Shot
Reusing dataset snli (/home/shana92/.cache/huggingface/datasets/snli/plain_text/1.0.0/1f60b67533b65ae0275561ff7828aad5ee4282d0e6f844fd148d05d3c6ea251b)
100%|████████████████████████████████| 10/10 [00:00<00:00, 261.45ba/s]
100%|████████████████████████████████| 10/10 [00:00<00:00, 161.32ba/s]
100%|███████████████████████████| 9824/9824 [00:01<00:00, 5958.47ex/s]
100%|█████████████████████████████████| 10/10 [00:00<00:00, 51.68ba/s]
  0%|          | 0/77 [00:00<?, ?it/s]
Seed: 2 - Dataset: SNLI (test) - Accuracy: 83.978015%, RK: 0.759950
End: In-Distribution Evaluation - SNLI test - Zero-Shot

Begin: Out-of-Distribution Evaluation - HANS - Zero-Shot
Reusing dataset hans (/home/shana92/.cache/huggingface/datasets/hans/plain_text/1.0.0/452e93cf5383f5ae39088254215b517d0da98ccaaf0af8f7ab04d8f23f67dbd9)
100%|████████████████████████████████| 30/30 [00:00<00:00, 107.41ba/s]
100%|█████████████████████████████████| 30/30 [00:00<00:00, 55.20ba/s]
100%|█████████████████████████| 30000/30000 [00:05<00:00, 5623.69ex/s]
100%|█████████████████████████████████| 30/30 [00:00<00:00, 46.45ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 27.63ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 26.48ba/s]
100%|█████████████████████████████████| 30/30 [00:01<00:00, 27.63ba/s]
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 2 - Dataset: constituent - Accuracy: 50.000000%, RK: 0.000000
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 2 - Dataset: lexical_overlap - Accuracy: 50.000000%, RK: 0.000000
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 2 - Dataset: subsequence - Accuracy: 49.990001%, RK: -0.010000
End: Out-of-Distribution Evaluation - HANS - Zero-Shot
Begin: Out-of-Distribution Evaluation - NLI Diagnostics - Zero-Shot
100%|███████████████████████████| 1104/1104 [00:00<00:00, 9040.24ex/s]
100%|███████████████████████████| 1104/1104 [00:00<00:00, 4471.22ex/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 56.59ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.58ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.03ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.36ba/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 39.02ba/s]
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 2 - Dataset: Lexical Semantics - Accuracy: 42.663044%, RK: 0.108367
  0%|          | 0/4 [00:00<?, ?it/s]
Seed: 2 - Dataset: Predicate-Argument Structure - Accuracy: 56.603771%, RK: 0.252428
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 2 - Dataset: Logic - Accuracy: 42.307693%, RK: 0.128686
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 2 - Dataset: Knowledge - Accuracy: 37.323943%, RK: 0.084887
End: Out-of-Distribution Evaluation - NLI Diagnostics - Zero-Shot
Begin: Out-of-Distribution Evaluation - Stress Tests - Zero-Shot
100%|████████████████████████| 24071/24071 [00:02<00:00, 10462.60ex/s]
100%|█████████████████████████| 24071/24071 [00:05<00:00, 4390.01ex/s]
100%|█████████████████████████████████| 25/25 [00:00<00:00, 33.02ba/s]
Heuristic: Competence - 396 (1.672650%) sequences excluded
100%|██████████████████████| 294705/294705 [00:28<00:00, 10395.74ex/s]
100%|███████████████████████| 294705/294705 [01:07<00:00, 4357.01ex/s]
100%|███████████████████████████████| 295/295 [00:09<00:00, 31.91ba/s]
Heuristic: Distraction - 1060 (0.360980%) sequences excluded
100%|██████████████████████| 333160/333160 [00:32<00:00, 10387.12ex/s]
100%|███████████████████████| 333160/333160 [01:11<00:00, 4666.62ex/s]
100%|███████████████████████████████| 334/334 [00:09<00:00, 36.03ba/s]
Heuristic: Noise - 1070 (0.322202%) sequences excluded
  0%|          | 0/185 [00:00<?, ?it/s]
Seed: 2 - Dataset: Competence - Accuracy: 25.208026%, RK: -0.120202
  0%|          | 0/2295 [00:00<?, ?it/s]
Seed: 2 - Dataset: Distraction - Accuracy: 48.405388%, RK: 0.250649
  0%|          | 0/2595 [00:00<?, ?it/s]
Seed: 2 - Dataset: Noise - Accuracy: 54.373813%, RK: 0.323304
End: Out-of-Distribution Evaluation - Stress Tests - Zero-Shot
Begin: Out-of-Distribution Evaluation - ANLI - Zero-Shot
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████| 17/17 [00:00<00:00, 214.97ba/s]
100%|█████████████████████████| 16946/16946 [00:05<00:00, 3010.61ex/s]
100%|█████████████████████████████████| 17/17 [00:00<00:00, 19.08ba/s]
Split: train_r1 - 446 (2.703030%) sequences excluded
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.686365  [    0/16500]
loss: 0.622635  [ 1600/16500]
loss: 0.685451  [ 3200/16500]
loss: 0.602146  [ 4800/16500]
loss: 0.651027  [ 6400/16500]
loss: 0.607988  [ 8000/16500]
loss: 0.629272  [ 9600/16500]
loss: 0.591405  [11200/16500]
loss: 0.624658  [12800/16500]
loss: 0.634252  [14400/16500]
loss: 0.590716  [16000/16500]
Epoch average loss: 0.6281501054763794
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.631486  [    0/16500]
loss: 0.606428  [ 1600/16500]
loss: 0.622679  [ 3200/16500]
loss: 0.620982  [ 4800/16500]
loss: 0.627165  [ 6400/16500]
loss: 0.575666  [ 8000/16500]
loss: 0.620206  [ 9600/16500]
loss: 0.624976  [11200/16500]
loss: 0.603559  [12800/16500]
loss: 0.593871  [14400/16500]
loss: 0.609685  [16000/16500]
Epoch average loss: 0.6181387901306152
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.605308  [    0/16500]
loss: 0.599334  [ 1600/16500]
loss: 0.604707  [ 3200/16500]
loss: 0.531621  [ 4800/16500]
loss: 0.649215  [ 6400/16500]
loss: 0.593846  [ 8000/16500]
loss: 0.597807  [ 9600/16500]
loss: 0.557479  [11200/16500]
loss: 0.601580  [12800/16500]
loss: 0.607290  [14400/16500]
loss: 0.642588  [16000/16500]
Epoch average loss: 0.6030129790306091
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|███████████████████████████████████| 1/1 [00:00<00:00, 98.33ba/s]
100%|███████████████████████████| 1000/1000 [00:00<00:00, 2938.46ex/s]
100%|███████████████████████████████████| 1/1 [00:00<00:00, 18.69ba/s]
Split: test_r1 - 23 (2.354145%) sequences excluded
  0%|          | 0/16 [00:00<?, ?it/s]
Round: r1 - Seed: 2 - Accuracy: 31.218013%, RK: -0.039549
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████| 46/46 [00:00<00:00, 250.04ba/s]
100%|█████████████████████████| 45460/45460 [00:14<00:00, 3093.86ex/s]
100%|█████████████████████████████████| 46/46 [00:02<00:00, 19.92ba/s]
Split: train_r2 - 944 (2.120586%) sequences excluded
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.649130  [    0/44516]
loss: 0.600430  [ 4416/44516]
loss: 0.595543  [ 8832/44516]
loss: 0.620684  [13248/44516]
loss: 0.573597  [17664/44516]
loss: 0.594769  [22080/44516]
loss: 0.595165  [26496/44516]
loss: 0.604804  [30912/44516]
loss: 0.625194  [35328/44516]
loss: 0.610677  [39744/44516]
loss: 0.560324  [44160/44516]
Epoch average loss: 0.6086877584457397
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.588814  [    0/44516]
loss: 0.604258  [ 4416/44516]
loss: 0.560081  [ 8832/44516]
loss: 0.627984  [13248/44516]
loss: 0.525151  [17664/44516]
loss: 0.617112  [22080/44516]
loss: 0.605722  [26496/44516]
loss: 0.589089  [30912/44516]
loss: 0.554719  [35328/44516]
loss: 0.568077  [39744/44516]
loss: 0.601605  [44160/44516]
Epoch average loss: 0.5792346000671387
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.534678  [    0/44516]
loss: 0.561176  [ 4416/44516]
loss: 0.508755  [ 8832/44516]
loss: 0.595381  [13248/44516]
loss: 0.569625  [17664/44516]
loss: 0.589464  [22080/44516]
loss: 0.525621  [26496/44516]
loss: 0.491484  [30912/44516]
loss: 0.528375  [35328/44516]
loss: 0.538716  [39744/44516]
loss: 0.539622  [44160/44516]
Epoch average loss: 0.5482663512229919
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████| 1/1 [00:00<00:00, 182.79ba/s]
100%|███████████████████████████| 1000/1000 [00:00<00:00, 3006.65ex/s]
100%|███████████████████████████████████| 1/1 [00:00<00:00, 18.90ba/s]
Split: test_r2 - 18 (1.832994%) sequences excluded
  0%|          | 0/16 [00:00<?, ?it/s]
Round: r2 - Seed: 2 - Accuracy: 31.262729%, RK: -0.033116
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████| 101/101 [00:00<00:00, 246.52ba/s]
100%|███████████████████████| 100459/100459 [00:30<00:00, 3274.75ex/s]
100%|███████████████████████████████| 101/101 [00:04<00:00, 20.26ba/s]
Split: train_r3 - 7468 (8.030885%) sequences excluded
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.612488  [    0/92991]
loss: 0.627321  [ 9280/92991]
loss: 0.610361  [18560/92991]
loss: 0.657847  [27840/92991]
loss: 0.577825  [37120/92991]
loss: 0.599512  [46400/92991]
loss: 0.591862  [55680/92991]
loss: 0.595262  [64960/92991]
loss: 0.605619  [74240/92991]
loss: 0.534788  [83520/92991]
loss: 0.601606  [92800/92991]
Epoch average loss: 0.5927404761314392
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.609934  [    0/92991]
loss: 0.510853  [ 9280/92991]
loss: 0.558444  [18560/92991]
loss: 0.595187  [27840/92991]
loss: 0.563072  [37120/92991]
loss: 0.530292  [46400/92991]
loss: 0.570459  [55680/92991]
loss: 0.605700  [64960/92991]
loss: 0.511535  [74240/92991]
loss: 0.536649  [83520/92991]
loss: 0.506873  [92800/92991]
Epoch average loss: 0.5648192167282104
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.486739  [    0/92991]
loss: 0.503741  [ 9280/92991]
loss: 0.560463  [18560/92991]
loss: 0.594853  [27840/92991]
loss: 0.526683  [37120/92991]
loss: 0.572235  [46400/92991]
loss: 0.517994  [55680/92991]
loss: 0.578816  [64960/92991]
loss: 0.525229  [74240/92991]
loss: 0.478000  [83520/92991]
loss: 0.678244  [92800/92991]
Epoch average loss: 0.5371440052986145
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████| 2/2 [00:00<00:00, 274.36ba/s]
100%|███████████████████████████| 1200/1200 [00:00<00:00, 3275.64ex/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 33.49ba/s]
Split: test_r3 - 90 (8.108108%) sequences excluded
  0%|          | 0/18 [00:00<?, ?it/s]
Round: r3 - Seed: 2 - Accuracy: 34.054053%, RK: 0.006984
End: Out-of-Distribution Evaluation - ANLI - Zero-Shot
(text) lnx00191 [~/adversarial_nli_gpt2]> 
