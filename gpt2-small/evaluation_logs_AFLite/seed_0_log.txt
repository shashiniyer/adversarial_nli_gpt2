(text) lnx00191 [~/adversarial_nli_gpt2]> python3 evaluate_AFLite.py 0
Begin: In-Distribution Evaluation - SNLI test - Zero-Shot
Reusing dataset snli (/home/shana92/.cache/huggingface/datasets/snli/plain_text/1.0.0/1f60b67533b65ae0275561ff7828aad5ee4282d0e6f844fd148d05d3c6ea251b)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 221.55ba/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 172.08ba/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9824/9824 [00:01<00:00, 5936.62ex/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 52.23ba/s]
  0%|          | 0/77 [00:00<?, ?it/s]
Seed: 0 - Dataset: SNLI (test) - Accuracy: 83.764249%, RK: 0.757154
End: In-Distribution Evaluation - SNLI test - Zero-Shot

Begin: Out-of-Distribution Evaluation - HANS - Zero-Shot
Reusing dataset hans (/home/shana92/.cache/huggingface/datasets/hans/plain_text/1.0.0/452e93cf5383f5ae39088254215b517d0da98ccaaf0af8f7ab04d8f23f67dbd9)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 106.44ba/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 57.29ba/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30000/30000 [00:05<00:00, 5602.53ex/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 47.10ba/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 28.27ba/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 27.11ba/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 28.15ba/s]
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 0 - Dataset: constituent - Accuracy: 49.970001%, RK: -0.010004
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 0 - Dataset: lexical_overlap - Accuracy: 50.000000%, RK: 0.000000
  0%|          | 0/79 [00:00<?, ?it/s]
Seed: 0 - Dataset: subsequence - Accuracy: 49.990001%, RK: -0.010000
End: Out-of-Distribution Evaluation - HANS - Zero-Shot
Begin: Out-of-Distribution Evaluation - NLI Diagnostics - Zero-Shot
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1104/1104 [00:00<00:00, 9205.28ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1104/1104 [00:00<00:00, 4507.93ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 56.44ba/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 39.34ba/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 39.83ba/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 39.51ba/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 39.71ba/s]
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 0 - Dataset: Lexical Semantics - Accuracy: 45.108697%, RK: 0.130733
  0%|          | 0/4 [00:00<?, ?it/s]
Seed: 0 - Dataset: Predicate-Argument Structure - Accuracy: 56.367922%, RK: 0.240597
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 0 - Dataset: Logic - Accuracy: 42.307693%, RK: 0.136413
  0%|          | 0/3 [00:00<?, ?it/s]
Seed: 0 - Dataset: Knowledge - Accuracy: 42.957747%, RK: 0.131018
End: Out-of-Distribution Evaluation - NLI Diagnostics - Zero-Shot
Begin: Out-of-Distribution Evaluation - Stress Tests - Zero-Shot
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 24071/24071 [00:02<00:00, 10704.43ex/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 24071/24071 [00:05<00:00, 4457.16ex/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:00<00:00, 34.93ba/s]
Heuristic: Competence - 396 (1.672650%) sequences excluded
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 294705/294705 [00:27<00:00, 10611.94ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 294705/294705 [01:06<00:00, 4412.24ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 295/295 [00:08<00:00, 32.80ba/s]
Heuristic: Distraction - 1060 (0.360980%) sequences excluded
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 333160/333160 [00:31<00:00, 10619.75ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 333160/333160 [01:09<00:00, 4773.62ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 334/334 [00:09<00:00, 37.08ba/s]
Heuristic: Noise - 1070 (0.322202%) sequences excluded
  0%|          | 0/185 [00:00<?, ?it/s]
Seed: 0 - Dataset: Competence - Accuracy: 21.900739%, RK: -0.182475
  0%|          | 0/2295 [00:00<?, ?it/s]
Seed: 0 - Dataset: Distraction - Accuracy: 50.572973%, RK: 0.264185
  0%|          | 0/2595 [00:00<?, ?it/s]
Seed: 0 - Dataset: Noise - Accuracy: 55.530125%, RK: 0.333482
End: Out-of-Distribution Evaluation - Stress Tests - Zero-Shot
Begin: Out-of-Distribution Evaluation - ANLI - Zero-Shot
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 209.45ba/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16946/16946 [00:05<00:00, 3153.52ex/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 20.02ba/s]
Split: train_r1 - 446 (2.703030%) sequences excluded
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.691505  [    0/16500]
loss: 0.637810  [ 1600/16500]
loss: 0.661517  [ 3200/16500]
loss: 0.614835  [ 4800/16500]
loss: 0.637002  [ 6400/16500]
loss: 0.608296  [ 8000/16500]
loss: 0.626352  [ 9600/16500]
loss: 0.600416  [11200/16500]
loss: 0.630758  [12800/16500]
loss: 0.632441  [14400/16500]
loss: 0.592021  [16000/16500]
Epoch average loss: 0.630757749080658
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.636288  [    0/16500]
loss: 0.610345  [ 1600/16500]
loss: 0.642369  [ 3200/16500]
loss: 0.614969  [ 4800/16500]
loss: 0.637091  [ 6400/16500]
loss: 0.572471  [ 8000/16500]
loss: 0.617624  [ 9600/16500]
loss: 0.631860  [11200/16500]
loss: 0.595643  [12800/16500]
loss: 0.609514  [14400/16500]
loss: 0.609767  [16000/16500]
Epoch average loss: 0.6204996705055237
  0%|          | 0/258 [00:00<?, ?it/s]
loss: 0.592436  [    0/16500]
loss: 0.607902  [ 1600/16500]
loss: 0.636862  [ 3200/16500]
loss: 0.539406  [ 4800/16500]
loss: 0.641007  [ 6400/16500]
loss: 0.586969  [ 8000/16500]
loss: 0.579607  [ 9600/16500]
loss: 0.543148  [11200/16500]
loss: 0.610336  [12800/16500]
loss: 0.608472  [14400/16500]
loss: 0.645166  [16000/16500]
Epoch average loss: 0.6067090034484863
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 142.10ba/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:00<00:00, 3087.84ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.49ba/s]
Split: test_r1 - 23 (2.354145%) sequences excluded
  0%|          | 0/16 [00:00<?, ?it/s]
Round: r1 - Seed: 0 - Accuracy: 31.934494%, RK: -0.025406
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 46/46 [00:00<00:00, 222.38ba/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 45460/45460 [00:14<00:00, 3155.88ex/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 46/46 [00:02<00:00, 20.50ba/s]
Split: train_r2 - 944 (2.120586%) sequences excluded
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.587978  [    0/44516]
loss: 0.589022  [ 4416/44516]
loss: 0.598743  [ 8832/44516]
loss: 0.622620  [13248/44516]
loss: 0.572018  [17664/44516]
loss: 0.602210  [22080/44516]
loss: 0.584468  [26496/44516]
loss: 0.615418  [30912/44516]
loss: 0.628711  [35328/44516]
loss: 0.619256  [39744/44516]
loss: 0.573392  [44160/44516]
Epoch average loss: 0.6093168258666992
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.580591  [    0/44516]
loss: 0.586290  [ 4416/44516]
loss: 0.565528  [ 8832/44516]
loss: 0.607040  [13248/44516]
loss: 0.541890  [17664/44516]
loss: 0.592023  [22080/44516]
loss: 0.601677  [26496/44516]
loss: 0.589561  [30912/44516]
loss: 0.576578  [35328/44516]
loss: 0.550442  [39744/44516]
loss: 0.599352  [44160/44516]
Epoch average loss: 0.5819464921951294
  0%|          | 0/696 [00:00<?, ?it/s]
loss: 0.531196  [    0/44516]
loss: 0.575099  [ 4416/44516]
loss: 0.518410  [ 8832/44516]
loss: 0.584921  [13248/44516]
loss: 0.605577  [17664/44516]
loss: 0.569676  [22080/44516]
loss: 0.538960  [26496/44516]
loss: 0.500952  [30912/44516]
loss: 0.591360  [35328/44516]
loss: 0.550172  [39744/44516]
loss: 0.565046  [44160/44516]
Epoch average loss: 0.5522445440292358
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 163.85ba/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:00<00:00, 3105.79ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.66ba/s]
Split: test_r2 - 18 (1.832994%) sequences excluded
  0%|          | 0/16 [00:00<?, ?it/s]
Round: r2 - Seed: 0 - Accuracy: 31.975561%, RK: -0.023660
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 101/101 [00:00<00:00, 270.35ba/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100459/100459 [00:29<00:00, 3364.79ex/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 101/101 [00:04<00:00, 21.55ba/s]
Split: train_r3 - 7468 (8.030885%) sequences excluded
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.625147  [    0/92991]
loss: 0.635918  [ 9280/92991]
loss: 0.606795  [18560/92991]
loss: 0.651925  [27840/92991]
loss: 0.587021  [37120/92991]
loss: 0.593628  [46400/92991]
loss: 0.608541  [55680/92991]
loss: 0.584823  [64960/92991]
loss: 0.601966  [74240/92991]
loss: 0.530690  [83520/92991]
loss: 0.605392  [92800/92991]
Epoch average loss: 0.5922002196311951
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.600353  [    0/92991]
loss: 0.500424  [ 9280/92991]
loss: 0.548106  [18560/92991]
loss: 0.615856  [27840/92991]
loss: 0.534661  [37120/92991]
loss: 0.569278  [46400/92991]
loss: 0.589944  [55680/92991]
loss: 0.616609  [64960/92991]
loss: 0.505365  [74240/92991]
loss: 0.511635  [83520/92991]
loss: 0.554260  [92800/92991]
Epoch average loss: 0.5632364153862
  0%|          | 0/1453 [00:00<?, ?it/s]
loss: 0.477226  [    0/92991]
loss: 0.516071  [ 9280/92991]
loss: 0.585803  [18560/92991]
loss: 0.603233  [27840/92991]
loss: 0.517027  [37120/92991]
loss: 0.543086  [46400/92991]
loss: 0.537548  [55680/92991]
loss: 0.605265  [64960/92991]
loss: 0.523908  [74240/92991]
loss: 0.474493  [83520/92991]
loss: 0.642959  [92800/92991]
Epoch average loss: 0.5365267395973206
Done!
Reusing dataset anli (/home/shana92/.cache/huggingface/datasets/anli/plain_text/0.1.0/aabce88453b06dff21c201855ea83283bab0390bff746deadb30b65695755c0b)
100%|██████████████████████████████████| 2/2 [00:00<00:00, 268.80ba/s]
100%|███████████████████████████| 1200/1200 [00:00<00:00, 3297.32ex/s]
100%|███████████████████████████████████| 2/2 [00:00<00:00, 35.08ba/s]
Split: test_r3 - 90 (8.108108%) sequences excluded
  0%|          | 0/18 [00:00<?, ?it/s]
Round: r3 - Seed: 0 - Accuracy: 34.414414%, RK: 0.013079
End: Out-of-Distribution Evaluation - ANLI - Zero-Shot
(text) lnx00191 [~/adversarial_nli_gpt2]> 
